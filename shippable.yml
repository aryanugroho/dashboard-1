language: node_js

node_js: 
    - 0.12

# build image
build_image: shippableimages/ubuntu1404_nodejs
env: 
  global:
    - SLACK_ORG=Ottemo PROJECT=Dashboard
    - secure: LzKm/EnFUlWGxf3LHhnmaV9w1OajVFuZLBkbF3rFJi93p5QFsd5OqDT6eoj4zZOBkCdAK6yFbLajzc8X/xQfl0ULytbMmTaU28WeF/Rvc3YVjsoNgvtLHc5mrRzBLeO1wSw5cg04bRmHVAZok53e2iPcIOnU4ycpJ3y+Z6i5fTvMDPlGqQOIP5XuX3GkbFmyWHUTYKOWn/qXUlvU6Olo/z4SEilaI+XIi7PdKT289xT+GZx+0UtAzNB7cTTkk9Bp0g1EvIlz3YUxRAHefpjNZfDfaq1xxrdoA7DitqEoBN453JkzM4klfuZA+Kim1YicAuJbr5lljhFnGavq5o31Tg==

# only build/deploy the develop branch
branch:
    only:
        - develop

after_failure:
    - python slack_notifier.py --org $SLACK_ORG --project $PROJECT --token $SLACK_TOKEN

after_success:
    - REMOTE_HOST=kg.dev.ottemo.io bash deploy.sh
    - REMOTE_HOST=rk.dev.ottemo.io bash deploy.sh
    - REMOTE_HOST=ub-staging.ottemo.io bash deploy.sh
    - python slack_notifier.py --org $SLACK_ORG --project $PROJECT --token $SLACK_TOKEN -s

notifications:
    email: false
