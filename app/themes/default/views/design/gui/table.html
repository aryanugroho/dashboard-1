<section ng-init="init()">
    <form role="form" class="form-group">
       
        <!-- Pagination -->
        <gui-paginator object="this"></gui-paginator>
        
        <!-- Columns/filters/add/remove buttons -->
        <div>
            <div class="btn-group pull-left">
                <button class="btn btn-primary" ng-click="parent.remove()" ng-if="buttons.delete">Delete</button>
                <button class="btn btn-default" ng-click="parent.create()" ng-if="buttons.new">New</button>
            </div>
            
            <div class="btn-group pull-right">
                <button class="btn btn-default" data-toggle="modal" data-target="#myModal" ng-if="parent.fields.length > 1">Columns</span>
                <button class="filters btn btn-primary" ng-if="parent.fields.length > 1" >Filters</span>
            </div>
            <div class="clearfix"></div>
        </div>
        

        <div class="clearfix"></div>
        <br>

        <div class="table-responsive">
            <table class="table table-hover table-bordered table-striped" id="table_manager">
                <!-- Labels -->
                <thead>
                    <tr>
                        <th class="checkboxes-column">
                            <input type="checkbox" id="selectAll" ng-click="selectAll()">
                        </th>
                        <th ng-repeat="field in parent.fields" ng-show="field.visible" ng-class="{'text-uppercase': field.label}" ng-click="field.label ? setSort(field.attribute) : ''">
                            {{field.label}}
                            <span ng-class="getSortClass(field.attribute)"></span>
                        </th>
                    </tr>
                    <!-- Filters -->
                    <tr id="filters" ng-hide="filters.length <= 1 && !filters[0].visible">
                        <th>&nbsp;</th>
                        <th ng-repeat="filter in filters" ng-switch="filter.type" ng-show="parent.fields[$index].visible">
                            <div ng-switch-when="text">
                                <gui-filter-text editor-scope="filter.attributes" item="filter" object="this"></gui-filter-text>
                            </div>

                            <div ng-switch-when="range">
                                <gui-filter-range editor-scope="filter.attributes" item="filter" object="this"></gui-filter-range>
                            </div>

                            <div ng-switch-when="select">
                                <gui-filter-select editor-scope="filter.attributes" item="filter" object="this"></gui-filter-select>
                            </div>
                            <div ng-switch-default="">
                                &nbsp;
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="_item in items">
                        <td class="checkboxes-column">
                            <input type="checkbox" ng-if="!_item.IsStatic" ng-model="parent.idsSelectedRows[_item[map.id]]">
                        </td>
                        <td ng-click="parent.select(_item[map.id])" ng-repeat="field in parent.fields" ng-show="field.visible" 
                        ng-class="{'select-link': field.type ==='select-link'}">
                            <span ng-switch="field.type">

                                <!-- Image -->
                                <span ng-switch-when="image">
                                    <img class="media-object" ng-src="{{parent.getImage(_item[field.attribute])}}"
                                         alt="{{item[map.name]}}" style="max-width: 75px; max-height: 75px;">
                                </span>

                                <!-- Currency -->
                                <span ng-switch-when="price">{{_item[field.attribute] | currency}}</span>
                                <span ng-switch-when="currency">{{_item[field.attribute] | currency}}</span>

                                <!-- Link -->
                                <span ng-switch-when="select-link">
                                    <div>{{_item[field.attribute]}}</div>
                                </span>

                                <!-- String, text -->
                                <span ng-switch-default="">{{_item[field.attribute]}}</span>

                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <gui-paginator object="this"></gui-paginator>
        <!-- button group -->
        <div class="text-center">
            <button class="btn btn-primary" ng-click="parent.remove()" ng-if="buttons.delete">Delete</button>
            <button class="btn btn-default" ng-click="parent.create()" ng-if="buttons.new">New</button>
        </div>
    </form>
</section>

<!-- Modal columns -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">
                    Select columns
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                </h4> 
            </div>
            <div class="modal-body">
                <div class="row">
                    <label class="col-xs-12 col-sm-6" ng-repeat="field in parent.fields" ng-hide="field.notDisable">
                        <input type="checkbox" ng-model="field.visible" ng-hide="field.notDisable">
                        {{field.label || field.attribute}}
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
     </div>
</div>
