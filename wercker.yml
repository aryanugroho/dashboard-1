box: wercker/nodejs

# Build definition
build:
  # The steps that will be executed on build
  steps:
    - script: 
        name: Install notify-send
        code: sudo add-apt-repository ppa:leolik/leolik -y && sudo apt-get update && sudo apt-get install notify-osd -y
    - script:
        name: Upgrade NPM
        code: sudo npm update -g npm
    - script:
        name: Install bower/gulp
        code: sudo npm install -g bower gulp && sudo npm install
    - script:
        name: Run Bower Install
        code: bower install
    - script:
        name: Build & Minify Dashboard
        code: gulp build
  after-steps:
    - wercker/hipchat-notify@1.0.3:
        token: $HIPCHAT_TOKEN
        room-id: 394852
        from-name: Wercker
deploy:
    steps:
        - wercker/add-ssh-key:
            keyname: REMOTE_HOST_KEY
        - add-to-known_hosts:
            hostname: $REMOTE_HOST
        - script:
            name: Copy dist dir to $REMOTE_HOST
            code: scp -r $WERCKER_SOURCE_DIR/dist ottemo@$REMOTE_HOST:/home/ottemo/dashboard
    after-steps:
        - wercker/hipchat-notify@1.0.3:
            token: $HIPCHAT_TOKEN
            room-id: 394852
            from-name: Wercker
